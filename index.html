<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Airton_OS | Painel de Controle</title>
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Share Tech Mono', monospace; background: #050505; color: #00ffcc; padding: 20px; }
    .header { text-align: center; border-bottom: 2px solid #00ffcc; padding-bottom: 20px; margin-bottom: 30px; }
    
    /* Formulário Hacker */
    .form-container { border: 1px dashed #00ffcc; padding: 20px; margin-bottom: 30px; background: rgba(0,255,204,0.05); }
    input { background: #000; border: 1px solid #00ffcc; color: #00ffcc; padding: 10px; margin: 5px; font-family: inherit; width: 250px; }
    button { background: #00ffcc; color: #000; border: none; padding: 10px 20px; cursor: pointer; font-family: inherit; font-weight: bold; }
    button:hover { background: #fff; }

    /* Grid de Projetos */
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
    .card { border: 1px solid #00ffcc; padding: 20px; position: relative; background: #000; }
    .btn-del { position: absolute; top: 10px; right: 10px; color: #ff0055; border: 1px solid #ff0055; background: none; padding: 2px 5px; cursor: pointer; }
    .tech { color: #ff0055; display: block; margin-top: 15px; font-size: 0.8rem; }
  </style>
</head>
<body>

<div class="header">
  <h1>> AIRTON_OLIVEIRA_OS</h1>
  <p id="status">CONECTANDO AO NÚCLEO...</p>
</div>

<div class="form-container">
  <h3>[ INJETAR_NOVO_PROJETO ]</h3>
  <input type="text" id="t" placeholder="Nome do Projeto">
  <input type="text" id="d" placeholder="Descrição">
  <input type="text" id="tc" placeholder="Tecnologias">
  <button onclick="addProject()">EXECUTAR_INJEÇÃO</button>
</div>

<div class="grid" id="container">
  </div>

<script>
  const API = 'http://localhost:3000/api/projects';

  async function load() {
    try {
      const res = await fetch(API);
      const data = await res.json();
      document.getElementById('status').innerText = `STATUS: ONLINE | NÚCLEOS: ${data.length}`;
      
      const container = document.getElementById('container');
      container.innerHTML = '';
      
      data.forEach(p => {
        container.innerHTML += `
          <div class="card">
            <button class="btn-del" onclick="delProject('${p.title}')">[X]</button>
            <h3>> ${p.title}</h3>
            <p>${p.description}</p>
            <span class="tech">${p.tech}</span>
          </div>`;
      });
    } catch (e) {
      document.getElementById('status').innerText = "STATUS: SERVIDOR OFFLINE (LIGUE O NODE)";
    }
  }

  async function addProject() {
    const title = document.getElementById('t').value;
    const description = document.getElementById('d').value;
    const tech = document.getElementById('tc').value;

    if(!title) return alert("Defina um título!");

    await fetch(API, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ title, description, tech })
    });

    document.getElementById('t').value = '';
    document.getElementById('d').value = '';
    document.getElementById('tc').value = '';
    load();
  }

  async function delProject(title) {
    if(confirm(`Eliminar ${title}?`)) {
      await fetch(API + '/' + encodeURIComponent(title), { method: 'DELETE' });
      load();
    }
  }

  window.onload = load;
</script>

</body>
</html>
